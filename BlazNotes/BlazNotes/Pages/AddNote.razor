@page "/add"
@inject IToastService toastService
@inject INoteService noteService

<h1>Add note</h1>
<div class="card">
    <div class="card-body">
        <EditForm Model="@command" OnValidSubmit="@AddNoteAsync">
            <DataAnnotationsValidator />

            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" bind="@command.Title" name="title"
                        class="form-control" placeholder="Input title here" />
                <ValidationMessage For="@(() => command.Title)" />
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea name="description" bind="@command.Description"
                            class="form-control" placeholder="Input description here"></textarea>
                <ValidationMessage For="@(() => command.Description)" />
            </div>
            <button type="reset" class="btn btn-secondary">Reset</button>
            <button type="submit" class="btn btn-success">Add</button>
        </EditForm>
    </div>
</div>

@functions
{
    private CreateNoteCommand command = new CreateNoteCommand();

    async Task AddNoteAsync()
    {
        try
        {
            await noteService.CreateAsync(command.Title, command.Description);
            toastService.ShowSuccess("Note added!", "Success");
        }
        catch (Exception)
        {
            toastService.ShowError("Something went wrong!", "Failed");
        }
        finally
        {
            // title = "";
            // description = "";
        }
    }
}